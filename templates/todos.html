<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="container mx-auto max-w-md">
        <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">Todo App</h1>
        
        <!-- Add Todo Form -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <form hx-post="/add" hx-target="#todo-list" hx-swap="innerHTML" class="flex gap-2">
                <input 
                    type="text" 
                    name="task" 
                    placeholder="Enter a new task..." 
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                    required
                    hx-on::after-request="this.value=''"
                >
                <button 
                    type="submit" 
                    class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                >
                    Add
                </button>
            </form>
        </div>

        <!-- Todo List -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div id="todo-list">
                {{template "todo-list" .}}
            </div>
        </div>
    </div>
</body>
</html>

{{define "todo-list"}}
{{if .}}
<ul class="space-y-2">
    {{range .}}
    <li class="flex items-center justify-between p-3 border border-gray-200 rounded-md">
        <form hx-post="/toggle" hx-target="#todo-list" hx-swap="innerHTML" class="flex-1">
            <input type="hidden" name="id" value="{{.ID}}" />
            <button class="flex items-center justify-between w-full text-left">
                <span class="{{if .Done}}line-through text-gray-500{{else}}text-gray-800{{end}}">
                    {{.Task}}
                </span>
                <span class="text-sm {{if .Done}}text-green-500{{else}}text-yellow-500{{end}} font-medium">
                    {{if .Done}}✓ Done{{else}}⏳ Pending{{end}}
                </span>
            </button>
        </form>
    </li>
    {{end}}
</ul>
{{else}}
<div class="text-center text-gray-500 py-8">
    <p class="text-lg">No todos yet!</p>
    <p class="text-sm">Add your first task above to get started.</p>
</div>
{{end}}
{{end}}
